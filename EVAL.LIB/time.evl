; Библиотека функций для работы с таймерами
; ИТЦ, Галеев 21.04.2015
;
;#INCLUDE "eval.lib\time.evl"

; -------   текущий час  ---------
func CurHour(t)
 return hour(time())
endfunc


; ------- таймеры --------------

; старт таймера
; id - номер таймера
func TimerStart(id)
  aout[id]=getticks(0)
endfunc

; gt:0-1 когда истек = 1
; id - номер таймера
; t - время в сек

func timerGT(id,t)
  if (eq(aout[id],0))
    aout[id]=getticks(0)
  else
    if (ge(getticks(aout[id])*ticksize(),t))
      ;aout[id]=0
      return(1)
    endif
  endif
  return(0)
endfunc

; lt:1-0 когда истек = 0
; id - номер таймера
; t - время в сек
func timerLT(id,t)
  if (eq(aout[id],0))
    aout[id]=getticks(0)
  else
    if (ge(getticks(aout[id])*ticksize(),t))
      ;aout[id]=0
      return(0)
    endif
  endif
  return(1)
endfunc

; периодически дает 1 через время t
func timerH(id,t)
  if (eq(aout[id],0))
    aout[id]=getticks(0)
  else
    if (ge(getticks(aout[id])*ticksize(),t))
      aout[id]=0
      return(1)
    endif
  endif
  return(0)
endfunc




