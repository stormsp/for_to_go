
; Galeev
; Расчет обьема газа при работе на байпасе
; при старте зонда обнулить переменные
    ; 5 переменных
    ;aout[ba+0] - время открытия
    ;aout[ba+1] - время закрытия
    ;aout[ba+2] - время работы на байпасе, час
    ;aout[ba+3] - объем газа на байпасе
    ;aout[ba+4] - время работы на байпасе, сек
    ; kr_bp - положение байпасного крана
    ; Vpsut - объем газа за прошлые сутки
    ; ba - базовый адрес

func Vbp(kr_bp,Vpsut,ba)
  if eq(kr_bp,1)
    if dost(aout[ba+1])
      aout[ba]=time()   ; время открытия
      aout[ba+1]=false(0)
    endif
    aout[ba+2]=(time()-aout[ba])/3600 ; в часах
    aout[ba+4]=(time()-aout[ba])      ; в сек
    aout[ba+3]=aout[ba+2]*Vpsut/24
  endif

  if eq(kr_bp,2)&eq(dost(aout[ba+1]),0)
    aout[ba+1]=time()
    aout[ba+2]=(aout[ba+1]-aout[ba])/3600
    aout[ba+4]=(aout[ba+1]-aout[ba])      ; в сек
  endif
  
endfunc
