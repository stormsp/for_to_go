; Преобразователь частоты Веспер 7011
; Галеев 11.2017

;0020h-Чтение состояния ПЧ
	;0 1: Вращение 0: Останов
	;1 1: Реверс 0: Нет реверса
	;2 Завершение подготовки к работе ПЧ- 1: Подготовка завершена 0: Не завершена
	;3 1: Авария ПЧ
	;4 1: Ошибка ввода данных
	;5 Состояние выходных клемм (MA-MB-MC) 1: Замкнуты MA-MC 0: Замкнуты MB-MC
	;6 Состояние выходных клемм (M1-M2) 1: Замкнуты 0: Разомкнуты
	;7-F Не используются

;0021h-Неисправности
	;0 Перегрузка по току (OC), Нарушение в цепи заземления	(GF), к.з. в нагрузке (SC)
	;1 Перегрузка по напряжению (OV)
	;2 Перегрузка преобразователя (OL2)
	;3 Перегрев теплоотвода (OH1, OH2)
	;4
	;5 Нарушение основной цепи (PUF)
	;6
	;7 Внешняя неисправность (EFO 0, 2, 3, 4, 5, 6)
	;8 Неисправность преобразователя (CPF 0, 1, 4, 5)
	;9 Перегрузка электродвигателя (OL1, OL3)
	;A
	;B Пропадание входного напряжения во время считывания состояния ПЧ
	;C Недостаточное напряжение (UV1, UV2, UV3)
	;D Обрыв фазы на входе или выходе (SPO, SPI)
	;E Неисправность в цепи торможения (rr, rH)
	;F

func vesper7011(bp,cod1,cod2)
  dout[bp+0]=ne(cod1 & 1, 0) 	;1: Вращение 0: Останов
  dout[bp+1]=ne(cod1 & 8, 0) 	;1: Авария ПЧ

  dout[bp+2]=ne(cod2 & 1, 0) 	;Перегрузка по току (OC), Нарушение в цепи заземления	(GF), к.з. в нагрузке (SC)
  dout[bp+3]=ne(cod2 & 2, 0) 	;Перегрузка по напряжению (OV)
  dout[bp+4]=ne(cod2 & 4, 0) 	;Перегрузка преобразователя (OL2)
  dout[bp+5]=ne(cod2 & 8, 0) 	;Перегрев теплоотвода (OH1, OH2)
  dout[bp+6]=ne(cod2 & 32, 0)	;Нарушение основной цепи (PUF)
  dout[bp+7]=ne(cod2 & 128, 0)	;Внешняя неисправность (EFO 0, 2, 3, 4, 5, 6)
  cod2=cod2/256
  dout[bp+8]=ne(cod2 & 1, 0)	;Неисправность преобразователя (CPF 0, 1, 4, 5)
  dout[bp+9]=ne(cod2 & 2, 0)	;Перегрузка электродвигателя (OL1, OL3)
  dout[bp+10]=ne(cod2 & 8, 0)	;Пропадание входного напряжения во время считывания состояния ПЧ
  dout[bp+11]=ne(cod2 & 16, 0)	;Недостаточное напряжение (UV1, UV2, UV3)
  dout[bp+12]=ne(cod2 & 32, 0)	;Обрыв фазы на входе или выходе (SPO, SPI)
  dout[bp+13]=ne(cod2 & 64, 0) 	;Неисправность в цепи торможения (rr, rH)
  return(0)                                       
endfunc

