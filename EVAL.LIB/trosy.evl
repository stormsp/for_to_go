; -----------------------------------------
; Приведение точки росы 
; к давлению 3.92 МПа по ГОСТ Р 53763-2009
; Галеев 12.13
; -----------------------------------------


; -------- пересчет в абсолютное давление ----------

; p_abs = Pizb_MPa + Patm_mm * 0.0001333224
; p_abs = Pizb_MPa + Patm_kPa * 0.001

;-----------------------------------------------------


func trosy_abs(p_abs,t)


 if(!dost(p)|!dost(t))
  return(false(0))
 endif
 
 tpr=false(0)
 p=p_abs
 ppr=3.92268

 if(ge(p,0.1)&le(p,2))
  a=((t+273.15)^-1)+0.000165153*ln(p)-0.004648
  w=exp(a/-0.000161)

  a=-0.000161*ln(w)-0.000165153*ln(ppr)+0.004648
  tpr=1/a-273.15
 endif

 if(gt(p,2)&le(p,10))
  a=23.9-1.7464*p+0.02592*p*p
  b=(753.06*p-3811.7)/(t+273.15)
  c=(111635*p+267960)/((t+273.15)^2)
  w=exp(a+b-c)
 
  a=1/(-0.0001956*ln(ppr)+0.004647)
  b=(-0.1495*ppr+6.938)*ln(w)
  c=0.4316*(ppr^0.28)*((ln(w))^2)
  tpr=a+b+c-273.15
 endif

 return(tpr)
endfunc
