
; в шестнадцатиричн.сист счисл, в таком коде 
; дает данные газоанализатор СТГ-3-И
; CH4, CO
func stgch4(vi,COD1,COD2)
  a=(COD2&15)+((COD2/16)&15)*10+((COD2/256)&15)*100+((COD2/4096)&15)*1000
  a=a+(COD1&15)*10000+((COD1/16)&15)*100000 ; передвигаем коды на 4 байта = 16
  HIB=COD1/256
  a=a*(10^(-(HIB&7)))     ; разделитель дробной части (запятая) есть, если число = 7 (0111)
  if (NE((HIB&128),0))    ; число отрицат, если старший байт = 1 (1000 0000 = 128)
    a=-a
  endif
  aout[vi+0]=a
  dout[vi+1]=gt(a,10)  ; загаз СН4 1 порог
  dout[vi+2]=gt(a,20)  ; загаз СН4 2 порог
  return(0)                                       
endfunc

func stgco(vi,COD1,COD2)
  a=(COD2&15)+((COD2/16)&15)*10+((COD2/256)&15)*100+((COD2/4096)&15)*1000
  a=a+(COD1&15)*10000+((COD1/16)&15)*100000 ; передвигаем коды на 4 байта = 16
  HIB=COD1/256
  a=a*(10^(-(HIB&7)))     ; разделитель дробной части (запятая) есть, если число = 7 (0111)
  if (NE((HIB&128),0))    ; число отрицат, если старший байт = 1 (1000 0000 = 128)
    a=-a
  endif
  aout[vi+0]=a
  dout[vi+1]=gt(a,20)  ; загаз СО 1 порог
  dout[vi+2]=gt(a,100)  ; загаз СО 2 порог
  return(0)                                       
endfunc


